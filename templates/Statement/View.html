{% extends "base.html" %}
{% block title %} Statements {% endblock %}

{% block head %}
    {{ super() }}
    <script type="text/javascript" src="{{ url_for('static', filename='js/base.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/table.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/form.css') }}">
{% endblock %}

{% block main %}

    <h1>Statement View</h1>

    <form class="simple-container" method="post">
        <input hidden value="{{ statement.id }}" name="id">
        <div class="form-row-container">
            <label for="name">Statement Name:</label>
            <input type="text" id="name" name="name" value="{{ statement.name }}">
        </div>
        <div class="form-row-container">
            <label for="reference">Statement Reference:</label>
            <input type="text" id="reference" readonly value="{{ statement.reference }}">
        </div>
        <div class="form-row-container">
            <label for="upload_date">Upload Date:</label>
            <input type="text" id="upload_date" readonly value="{{ statement.upload_date }}">
        </div>
        <div class="form-row-container">
            <label for="trx_count">Number of Transactions:</label>
            <input type="number" id="trx_count" readonly value="{{ statement.trx_count }}">
        </div>
        <div class="form-row-container">
            <label for="money_in_total">Total Money In:</label>
            <input class="green-text text-align-right" type="number" id="money_in_total" readonly value="{{ '%0.2f'| format(statement.money_in_total|float) }}">
        </div>
        <div class="form-row-container">
            <label for="money_out_total">Total Money Out:</label>
            <input class="red-text text-align-right" type="number" id="money_out_total" readonly value="{{ '%0.2f'| format(statement.money_out_total|float) }}">
        </div>
        <div class="form-row-container">
            <label for="date_oldest">Oldest Transaction:</label>
            <input type="text" id="date_oldest" readonly value="{{ statement.date_oldest }}">
        </div>
        <div class="form-row-container">
            <label for="date_newest">Latest Transaction:</label>
            <input type="text" id="date_newest" readonly value="{{ statement.date_newest }}">
        </div>
        <div class="form-row-container">
            <label for="currency">Account Currency Code:</label>
            <input type="text" id="currency" readonly value="{{ currency }}">
        </div>
        <div class="form-row-container">
            <button class="button-submit box-shadow form-item" type="submit" style="max-width: 100px; margin-right: 10px;">Update Name</button>
            {% if is_admin %}
                <button class="button-submit box-shadow form-item delete-btn" type="button" onclick="deleteRecord('/statement/view', {{ statement.id }}, 'Are you sure you want to delete this statement?', 'Statement Deleted - taking you to the Statement List', 'Failed to delete statement - ', true);" style="max-width: 200px;">Delete Statement</button>
            {% endif %}
        </div>
    </form>

    {% include 'messageBar.html' %}

    <br>
    <div class="header-row">
            <span style="min-width: 200px;">Date</span>
            <span style="min-width: 500px;">Description</span>
            <span style="min-width: 100px;">Money In</span>
            <span style="min-width: 100px;">Money Out</span>
            <span style="min-width: 100px;">Balance</span>
    </div>
    <div class="table-container">
        {% for t in trxs %}
            <div class="tr">
                <span style="min-width: 200px;">{{ t.date }}</span>
                <span style="min-width: 500px;">{{ t.description }}</span>
                <span class="text-align-right" style="min-width: 100px;">{% if t.money_in %} {{ '%0.2f'| format(t.money_in|float) }} {% endif %}</span>
                <span class="text-align-right" style="min-width: 100px;">{% if t.money_out %} {{ '%0.2f'| format(t.money_out|float) }} {% endif %}</span>
                <span class="text-align-right" style="min-width: 100px;">{{ '%0.2f'| format(t.balance|float) }}</span>
                {% if is_admin %}
                    <span style="min-width: 100px; display: flex; justify-content: center;">
                        <button class="bin-btn" type="button" onclick="deleteRecord('/statement/trx/delete', {{ t.id }}, 'Are you sure you want to delete this transaction from the statement?', 'Transaction deleted', 'Failed to delete transaction - ', true);">
                            <img class="icon bin-icon filter-dark-red">
                        </button>
                    </span>
                {% endif %}
            </div>
        {% endfor %}
    </div>


{% endblock %}
